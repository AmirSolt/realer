<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realer</title>




</head>
<body>


    <input type="search" name="" id="search_bar">
    <button id="search_btn">Search</button>
    
  

    <div id="card_container">

    </div>


    
    <iframe src="https://www.amazon.ca/s?k=shoes" width="800" height="600">
        <meta http-equiv="X-Frame-Options" content="deny">
    </iframe>


    <script>





        const search_bar = document.getElementById("search_bar");
        const search_btn = document.getElementById("search_btn");

        search_btn.addEventListener("click", async () => {
            let query = search_bar.value;
            console.log(query);



            let products = await fetch_products();

            let [] = await Promise.all([
                fetch_realer(products).then(realer => {
                    render_realer(realer);
                }),
                render_cards(products)
            ]);
           


        });


        async function fetch_realer(products) {
            console.log("fetching realer ... ");
            await new Promise(resolve => setTimeout(resolve, 5000));
            console.log("fetched realer ... ");
            return [];
        }

        async function render_realer(realer) {
            console.log("rendering realer ... ");
            await new Promise(resolve => setTimeout(resolve, 2000));
            console.log("rendered realer ... ");
            return [];
        }

        async function fetch_products() {
            console.log("fetching products ... ");
            const response = await fetch('https://fakestoreapi.com/products');
            const products = await response.json();
            console.log("fetched products ... ");
            return products;
        }


        async function render_cards(products) {
            console.log("rendering products ... ");
            products.forEach(product => {
                render_card(product);
            });
            console.log("rendered products ... ");

        }

        function render_card(product) {
            const card = `
            <div>
                <img src="${product.image}" alt="Image for ${product.title}">
                <h1>Title: ${product.title}</h1>
                <p>Desc: ${product.description}</p>
                <p>ID: ${product.id}</p>
                <p>Price: ${product.price}</p>
                <p>Rating: ${product.rating}</p>
                <p>Category: ${product.category}</p>
            </div>
            `
            const card_container = document.getElementById("card_container");
            card_container.innerHTML += card;
        }
  
    </script>
    
</body>
</html>